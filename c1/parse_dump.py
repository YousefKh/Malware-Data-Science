# parse program sections
import pefile as pef

pe = pef.PE("ircbot.exe")

for section in pe.sections:
    print(section.Name, hex(section.VirtualAddress),
            hex(section.Misc_VirtualSize), section.SizeOfRawData)

print '\nDinished parse a program sections\n'+'#'*50+'\nDumping a PE file"s IAT\n'

# dump IAT
for entry in pe.DIRECTORY_ENTRY_IMPORT:
    print entry.dll
    for func in entry.imports:
        print '\t', func.name
